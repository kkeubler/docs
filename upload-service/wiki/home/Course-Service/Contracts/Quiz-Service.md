# Create Quiz
We need the ability for a user to create a quiz, that is linked to the Course, therefore we need to trigger the creation.

## Proposal 1:

You provide an editor component, that creates a dom event on quiz creation, that includes the quiz id

```html
<quiz-create ></quiz-create >
```

## Proposal 2:

We redirect a user to the following frontend URL:
```
https://moodleduo.com/quiz/create/:creation_id/:callback_path
```
The User creates the Quiz with your Editor or the AI Service

You use our API to give us the quiz id and mark the quiz as active and link it to the course
```yaml
openapi: 3.0.3
info:
  title: Course Service API
  version: 1.0.0
  description: API specification for the Course Service — includes callback endpoint for receiving quiz creation results.
paths:
  /quiz/{creation_id}:
    post:
      summary: Callback endpoint for quiz creation
      description: >
        This endpoint is called by the Quiz Service after a quiz is created.
        The Quiz Service will send the `creation_id` originally provided when 
        creating the quiz, along with the new `quiz_id`.
      operationId: quizCreationCallback
      parameters:
        - in: path
          name: creation_id
          schema:
            type: uuid
          required: true
          description: Unique identifier for the quiz creation process, generated by the Course Service when redirecting to the Quiz Service.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - quiz_id
              properties:
                creation_id:
                  type: string
                  description: >
                    Unique identifier for the quiz creation process,
                    generated by the Course Service when redirecting to the Quiz Service.
                quiz_id:
                  type: string
                  description: >
                    Unique identifier for the newly created quiz.
      responses:
        '200':
          description: Callback processed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: Quiz registered in course service.
        '400':
          description: Invalid request payload.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: Missing creation_id or quiz_id.
        '404':
          description: creation_id not found.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: creation_id not found.
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: Unexpected server error.
```
Now you can navigate the user to the :callback_path, that he is back in the course site

# Edit Quiz
We want to give the user a way to edit a quiz

## Proposal 1:

You provide an editor component, that creates a dom event on save

```html
<quiz-edit id={quiz_id}></quiz-edit>
```

## Proposal 2:

We redirect a user to the following frontend URL:
```
https://moodleduo.com/quiz/edit/:id/:callback_path
```
The User creates the Quiz with your Editor or the AI Service, then you navigate back to the callback_path

# Quiz gets deleted by the user
We need to know when a quiz gets deleted, so that we can remove it from all courses

## Proposal 1:
Call a Callback in our Service
```yaml
openapi: 3.0.3
info:
  title: Course Service API
  version: 1.1.0
  description: >
    API specification for the Course Service — includes callback endpoints 
    for receiving quiz creation and deletion events from the Quiz Service.
paths:
  /quiz/{id}:
    delete:
      summary: Callback endpoint for quiz deletion
      description: Called by the Quiz Service after a quiz is deleted.
      operationId: quizDeletionCallback
      parameters:
        - in: path
          name: id
          schema:
            type: uuid
          required: true
          description: Numeric ID of the deleted quiz
      responses:
        '200':
          description: Callback processed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: Quiz deleted in course service.
        '400':
          description: Invalid request payload
        '500':
          description: Internal server error
```
## Proposal 2:
publish an event to a message queue, e.g. RabbitMQ

# Quiz deletion

We want to give the user the ability to delete a quiz

## Proposal
```yaml
openapi: 3.0.3
info:
  title: Quiz Service API
  version: 1.0.0
  description: >
    API specification for the Quiz Service — includes endpoint for deleting quizzes.
paths:
  /quizzes/{quiz_id}:
    delete:
      summary: Delete an existing quiz
      description: >
        Deletes an existing quiz identified by `quiz_id`.  
        After deletion, the Quiz Service will call the Course Service quiz deletion callback.
      operationId: deleteQuiz
      parameters:
        - name: quiz_id
          in: path
          required: true
          description: Unique identifier of the quiz to delete.
          schema:
            type: string
      responses:
        '200':
          description: Quiz deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: Quiz deleted successfully.
                  quiz_id:
                    type: string
                    example: 12345
        '404':
          description: Quiz not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: Quiz not found.
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: Unexpected server error.
```

# Display Quiz
We want a user to be able to display the quiz

## Proposal 1
You provide a component that displays the quiz
```html
<quiz-display id={quiz_id}></quiz-display>
```

## Proposal 2
We navigate the user to the quiz page
```
https://moodleduo.com/quiz/:id/:callback_path
```
You navigate him back to the callback path when appropriate

# Get Quiz(List)
We need to be able to get lists of:
- A Users quizes
  - id
  - name
  - (description)
  - (thumbnail)
  - visibility
- public quizzes
  - id
  - name
  - (description)
  - (thumbnail)
  - owner id
  - (owner name)
  - (owner profile picture)

We need to get information about a single quiz by id
  - name
  - (description)
  - (thumbnail)
  - owner id
  - (owner name)
  - (owner profile picture)
  - visibility

## Proposal
```yaml
openapi: 3.0.3
info:
  title: Quiz Service API
  version: 1.0.0
  description: API for retrieving user quizzes, public quizzes, and quiz details.

servers:
  - url: https://api.quizservice.com/v1

paths:
  /users/{userId}/quizzes:
    get:
      summary: Get quizzes owned by a specific user
      description: Retrieves a list of quizzes belonging to the specified user.
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the user.
      responses:
        '200':
          description: List of user's quizzes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserQuizSummary'

  /quizzes/public:
    get:
      summary: Get list of public quizzes
      description: Retrieves a list of quizzes that are publicly visible.
      responses:
        '200':
          description: List of public quizzes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PublicQuizSummary'

  /quizzes/{quizId}:
    get:
      summary: Get quiz details by ID
      description: Returns detailed information for a specific quiz.
      parameters:
        - name: quizId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the quiz.
      responses:
        '200':
          description: Quiz details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuizDetail'
        '404':
          description: Quiz not found

components:
  schemas:
    UserQuizSummary:
      type: object
      properties:
        id:
          type: string
          example: "quiz_123"
        name:
          type: string
          example: "World History Basics"
        description:
          type: string
          nullable: true
          example: "A simple introduction to world history."
        thumbnail:
          type: string
          nullable: true
          format: uri
          example: "https://cdn.quizservice.com/thumbnails/quiz_123.png"
        visibility:
          type: string
          enum: [public, private]
          example: "private"

    PublicQuizSummary:
      type: object
      properties:
        id:
          type: string
          example: "quiz_456"
        name:
          type: string
          example: "Math Challenge"
        description:
          type: string
          nullable: true
          example: "Test your math skills with fun puzzles."
        thumbnail:
          type: string
          nullable: true
          format: uri
          example: "https://cdn.quizservice.com/thumbnails/quiz_456.png"
        ownerId:
          type: string
          example: "user_123"
        ownerName:
          type: string
          nullable: true
          example: "Jane Doe"
        ownerProfilePicture:
          type: string
          nullable: true
          format: uri
          example: "https://cdn.quizservice.com/profiles/user_123.jpg"

    QuizDetail:
      type: object
      properties:
        name:
          type: string
          example: "Science Facts"
        description:
          type: string
          nullable: true
          example: "Interesting trivia about science."
        thumbnail:
          type: string
          nullable: true
          format: uri
          example: "https://cdn.quizservice.com/thumbnails/quiz_789.png"
        ownerId:
          type: string
          example: "user_456"
        ownerName:
          type: string
          nullable: true
          example: "John Smith"
        ownerProfilePicture:
          type: string
          nullable: true
          format: uri
          example: "https://cdn.quizservice.com/profiles/user_456.jpg"
        visibility:
          type: string
          enum: [public, private, unlisted]
          example: "public"
```
# Change quiz visibility
we want the ability to allow a user to change the quiz visibility, to link it to a course

## Proposal:
```
openapi: 3.0.3
info:
  title: Quiz Visibility Management API
  version: 1.0.0
  description: API endpoint for changing the visibility of a quiz.

servers:
  - url: https://api.quizservice.com/v1

paths:
  /quizzes/{quizId}/visibility:
    patch:
      summary: Change the visibility of a quiz
      description: Updates only the visibility setting for the specified quiz.
      parameters:
        - name: quizId
          in: path
          required: true
          schema:
            type: string
          description: The unique identifier of the quiz.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VisibilityUpdateRequest'
      responses:
        '200':
          description: Visibility updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuizVisibilityResponse'
        '400':
          description: Invalid visibility value or request format
        '404':
          description: Quiz not found
        '403':
          description: User does not have permission to change visibility

components:
  schemas:
    VisibilityUpdateRequest:
      type: object
      required:
        - visibility
      properties:
        visibility:
          type: string
          enum: [public, private, unlisted]
          example: public

    QuizVisibilityResponse:
      type: object
      properties:
        quizId:
          type: string
          example: quiz_123
        visibility:
          type: string
          enum: [public, private]
          example: public
        updatedAt:
          type: string
          format: date-time
          example: 2024-06-01T12:34:56Z
```